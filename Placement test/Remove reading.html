<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reading Test</title>
    <link rel="stylesheet" href="../../reading-styles.css" />
    <style>
      /* Container chứa cả Timer và Submit Button */
      #header-container {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  padding: 12px 20px;
  width: 99%;
  position: fixed;
  top: 0px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 999;
  background-color: rgb(247, 247, 247);
  border-bottom: 1px solid #fdfcfc;
  border-radius: 12px;
  box-shadow: 0 6px 15px rgba(2, 65, 120, 0.08);
}
h1, h2 {
      text-align: justify;
      color: #800000;
    }
.submit-button-container {
  display: flex;
  justify-content: flex-end;
}

.timer {
  display: flex;
      font-size: 20px;
  font-weight: bold;
  padding: 4px 12px;
  border: 2px solid #000;
  border-radius: 5px;
  background-color: #fff;
  flex-wrap: wrap;
  align-self:flex-start;
}


      #part-nav {
        justify-self: start;
        display: flex;
        gap: 10px;
      }

      #part-nav button {
        margin-right: 10px;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #999;
      background-color: #fff;
      cursor: pointer;
      }

      .submit-button-fixed {
        padding: 10px 16px;
      font-size: 16px;
      background-color: #800000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      }

      .submit-button-fixed:hover {
        background-color: #a00000;
      }

      .part {
        display: none;
      }

      .part.active {
        display: block;
      }

      #header-container.hidden,
      #part-nav.hidden {
        display: none;
      }
      .drop-target {
  display: inline-block;
  min-width: 100px;
  min-height: 28px;
  padding: 6px 10px;
  border: 1px dashed #aaa;
  border-radius: 8px;
  background: #fdfdfd;
  text-align: center;
  vertical-align: middle;
  margin: 0 5px;
  font-size: 14px;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.1);
  transition: box-shadow 0.2s ease, background-color 0.2s ease;
}
.drop-target.drop-hover {
  border-color: #007acc;
  background-color: #e6f7ff;
  box-shadow: 0 0 8px rgba(0, 122, 204, 0.4);
}
.word {
  display: inline-block;
  margin: 4px;
  padding: 6px 12px;
  background: #eee;
  border: 1px solid #aaa;
  border-radius: 8px;
  cursor: move;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
  transition: transform 0.1s ease, box-shadow 0.1s ease;
}

.word:hover {
  transform: scale(1.05);
  box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.25);
  cursor: grab;
}

.word:active {
  cursor: grabbing;
}

.hidden {
  display: none !important;
}
.mpc-question {
  margin-bottom: 15px;
}

.mpc-question p {
  margin-bottom: 5px;
  line-height: 1.6;
}

.mpc-question label {
  display: block; /* dùng block để mỗi đáp án 1 dòng */
  margin-bottom: 6px;
  cursor: pointer;
  font-weight: normal;
}

.mpc-question label span {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 6px;
  transition: background-color 0.15s;
}
.mpc-question label:hover span {
  background-color: rgba(0, 122, 204, 0.08); /* nền xanh nhạt như VS Code */
}
.mpc-question input[type="radio"]:checked + label,
.mpc-question label input[type="radio"]:checked {
  outline: 2px solid #007BFF;
  background-color: #eef6ff;
  border-radius: 4px;
  transition: all 0.2s ease-in-out;
}
.nav-left {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  gap: 12px;
}
.part-tab {
  font-weight: bold;
  cursor: pointer;
  padding: 6px 12px;
  border-radius: 6px;
  border: 1px solid #aaa;
  background: #fff;
}
.part-tab:hover {
  background: #eee;
}
.question-nav {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 4px;
}
.question-nav button {
  padding: 4px 8px;
  font-size: 13px;
  cursor: pointer;
  border: 1px solid #bbb;
  background: #fff;
  border-radius: 4px;
}
.nav-right {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
}
.submit-button {
  padding: 10px 16px;
  font-size: 16px;
  background-color: #800000;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.hidden {
  display: none;
}

#footer-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  background: #f9f9f9;
  border-top: 1px solid #ccc;
  display: flex;
  justify-content: space-between;
  padding: 12px 40px;
  box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
  z-index: 1000;
  font-family: 'Segoe UI', sans-serif;
  flex-wrap: wrap;
}


.radio-cell {
  position: relative;
  display: inline-block;
  width: 30px;
  height: 30px;
  border-radius: 8px;
  border: 1px solid transparent;
  cursor: pointer;
  transition: background-color 0.15s, border-color 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.radio-cell:hover {
  background-color: rgba(0, 122, 204, 0.08);
  border-color: #007acc;
  transform: scale(1.06); /* ← phóng to 6% khi hover */
}

.radio-cell input[type="radio"] {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%); /* ✅ căn giữa tuyệt đối */
  pointer-events: none;            /* click toàn vùng label */
  margin: 0;                       /* loại bỏ lệch mặc định */
  accent-color: #007acc;          /* màu xanh IELTS-like (tuỳ chọn) */
}
.question-nav button.answered {
  border: 2px solid #007BFF !important;
  background-color: #f0f8ff;
}
.highlight-yellow {
  background-color: #fff9b0;
  display: inline;
  transition: background-color 0.2s ease-in-out;
}
#highlight-popup {
  position: absolute;
  display: none;
  padding: 3px 5px;
  background: #1b0d3e;
  color: rgb(247, 243, 243);
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
  z-index: 9999;
  user-select: none;
}
#highlight-popup button {
  background: none;
  border: none;
  color: white;
  font-weight: bold;
  cursor: pointer;
  margin: 0 5px;
  font-size: 12px;
  padding: 5px 8px;
  text-decoration: none; /* Mặc định không gạch chân */
}

#highlight-popup button:hover {
  text-decoration: underline; /* Gạch chân khi hover */
}
.start-screen {
  max-width: 900px;
  margin: 20px auto;
  background: white;
  padding: 30px;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  font-family: Arial, sans-serif;
  line-height: 1.8; /* tăng khoảng cách dòng */
  text-align: justify;
}

/* ✅ Điều chỉnh danh sách có dấu chấm */
.start-screen ul {
  padding-left: 30px;     /* lùi vào trong */
  margin-bottom: 20px;    /* giãn dưới mỗi danh sách */
}

/* ✅ Điều chỉnh từng dòng của danh sách */
.start-screen ul li {
  margin-bottom: 10px;    /* giãn giữa các dòng */
}

    </style>
  </head>
  <body>
      <!-- ✅ Màn hình mở đầu -->
<div class="start-screen" id="start-screen">
  <h1>IELTS Academic Reading</h1><br>
  <h3>INSTRUCTIONS TO CANDIDATES</h3>
  <ul>
    <li><strong>Duration:</strong> 60 minutes</li>
    <li>Answer <strong>all</strong> passages.</li>
    <li>You can change your answers at any time during the test.</li>
  </ul>

  <h3>INFORMATION FOR CANDIDATES</h3>
  <ul>
    <li>This test consists of three passages with <strong>40</strong> questions.</li>
    <li>Each question is worth <strong>one</strong> mark.</li>
  </ul>
  <button class="submit-button-fixed" onclick="startReading()">Start test</button>
</div>
  <div id="main-content" style="display: none;">
      <!-- Passage 1 -->
  <div id="part-1" class="part active">
    <div class="container">
        <!-- Left side: Reading Passage -->
        <div class="left-column">
            <h2>READING PASSAGE 1</h2>
            <p class="center-text"><strong>Snow-makers</strong></p>
            <p></p>
            <p><strong>1</strong>
              <span class="drop-target" id="q1" name="q1" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>In the early to mid-twentieth century, with the growing popularity of skiing, ski slopes became extremely profitable businesses. But ski resort owners were completely dependent on the weather: if it didn't snow, or didn’t snow enough, they had to close everything down. Fortunately, a device called the snow gun can now provide snow whenever it is needed. These days such machines are standard equipment in the vast majority of ski resorts around the world, making it possible for many resorts to stay open for months or more a year.</p><br>
            <p><strong>2</strong>
              <span class="drop-target" id="q2" name="q2" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>Snow formed by natural weather systems comes from water vapour in the atmosphere. The water vapour condenses into droplets, forming clouds. If the temperature is sufficiently low, the water droplets freeze into tiny ice crystals. More water particles then condense onto the crystal and join with it to form a snowflake. As the snow flake grows heavier, it falls towards the Earth.</p><br>
            <p><strong>3</strong>
              <span class="drop-target" id="q3" name="q3" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>The snow gun works very differently from a natural weather system, but it accomplishes exactly the same thing. The device basically works by combining water and air. Two different hoses are attached to the gun. one leading from a water pumping station which pumps water up from a lake or reservoir, and the other leading from an air compressor. When the compressed air passes through the hose into the gun. it atomises the water - that is, it disrupts the stream so that the water splits up into tiny droplets. The droplets are then blown out of the gun and if the outside temperature is below 0°C, ice crystals will form, and will then make snowflakes in the same way as natural snow.</p><br>
            <p><strong>4</strong>
              <span class="drop-target" id="q4" name="q4" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>Snow-makers often talk about dry snow and wet snow. Dry snow has a relatively low amount of water, so it is very light and powdery. This type of snow is excellent for skiing because skis glide over it easily without getting stuck in wet slush. One of the advantages of using a snow-maker is that this powdery snow can be produced to give the ski slopes a level surface. However, on slopes which receive heavy use, resort owners also use denser, wet snow underneath the dry snow. Many resorts build up the snow depth this way once or twice a year, and then regularly coat the trails with a layer of dry snow throughout the winter.</p><br>
            <p><strong>5</strong>
              <span class="drop-target" id="q5" name="q5" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>The wetness of snow is dependent on the temperature and humidity outside, as well as the size of the water droplets launched by the gun. Snow-makers have to adjust the proportions of water and air in their snow guns to get the perfect snow consistency for the outdoor weather conditions. Many ski slopes now do this with a central computer system that is connected to weather-reading stations all over the slope.</p><br>
            <p><strong>6</strong>
              <span class="drop-target" id="q6" name="q6" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>But man-made snow makes heavy demands on the environment. It takes about 275,000 litres of water to create a blanket of snow covering a 60x60 metre area. Most resorts pump water from one or more reservoirs located in low-lying areas. The run-off water from the slopes feeds back into these reservoirs, so the resort can actually use the same water over and over again. However, considerable amounts of energy are needed to run the large air-compressing pumps, and the diesel engines which run them also cause air pollution.</p><br>
            <p><strong>7</strong>
              <span class="drop-target" id="q7" name="q7" ondragover="allowDrop(event)" ondrop="drop(event)" style="width: 500px; display: inline-block;">&nbsp;</span>
            </p>
            <p>Because of the expense of making snow, ski resorts have to balance the cost of running the machines with the benefits of extending the ski season, making sure they only make snow when it is really needed and when it will bring the maximum amount of profit in return for the investment. But man-made snow has a number of other uses as well. A layer of snow keeps a lot of the Earth’s heat from escaping into the atmosphere, so farmers often use man-made snow to provide insulation for winter crops. Snow-making machines have played a big part in many movie productions. Movie producers often take several months to shoot scenes that cover just a few days. If the movie takes place in a snowy setting, the set decorators have to get the right amount of snow for each day of shooting either by adding man-made snow or melting natural snow. And another important application of man-made snow is its use in the tests that aircraft must undergo in order to ensure that they can function safely in extreme conditions.</p>
        </div>

        <!-- Right side: Questions -->
        <div class="right-column">
            <h4>Questions 1-7</h4>
            <p>Reading Passage 1 has <strong>SEVEN</strong> paragraphs.</p>
            <p>Choose the correct heading for each paragraph and move it into the gap.</p>
            <p></p>
            <div class="word-bank">
              <strong>List of headings</strong>
              <p></p>
              <span class="word" data-text="Considering ecological costs" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Considering ecological costs</span>
              <span class="word" data-text="Modifications to the design of the snow gun" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Modifications to the design of the snow gun</span>
              <span class="word" data-text="The need for different varieties of snow" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">The need for different varieties of snow</span>
              <span class="word" data-text="Local concern over environmental issues" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Local concern over environmental issues</span>
              <span class="word" data-text="A problem and a solution" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">A problem and a solution</span>
              <span class="word" data-text="Applications beyond the ski slopes" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Applications beyond the ski slopes</span>
              <span class="word" data-text="Converting wet snow to dry snow" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Converting wet snow to dry snow</span>
              <span class="word" data-text="New method for calculating modifications" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">New method for calculating modifications</span>
              <span class="word" data-text="Artificial process, natural product" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Artificial process, natural product</span>
              <span class="word" data-text="Snow formation in nature" draggable="true" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc; cursor: move;">Snow formation in nature</span>
            </div>
        <br>
            <h4>Questions 8-10</h4>
        <p>Label the diagram below.</p>
        <p>Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer.</p>
        <div class="image-container" style="text-align: center; margin: 20px 0;">
          <img src="snowgun.png" alt="Diagram 1" style="max-width: 85%; height: auto;">
        </div>
        <p><strong>8</strong> <label for="q8"></label><input type="text" id="q8" name="q8" style="width: 100px; height: 25px;"></label> air</p><br>
        <p><strong>9</strong> Water is atomised into <label for="q9"></label><input type="text" id="q9" name="q9" style="width: 100px; height: 25px;"></label></p><br>
        <p><strong>10</strong> <label for="q10"></label><input type="text" id="q10" name="q10" style="width: 100px; height: 25px;"></label> are formed</p><br>
        <h4>Questions 11-13</h4>
        <p>Complete the sentences below.</p>
        <p>Choose <strong>NO MORE THAN THREE WORDS</strong> from the passage for each answer.</p><br>
        <p><strong>11</strong> The machinery used in the process of making the snow consumes a lot of <label for="q11"></label><input type="text" id="q11" name="q11" style="width: 100px; height: 25px;"></label> which is damaging to the environment.</p><br>
        <p><strong>12</strong> Artificial snow is used in agriculture as a type of <label for="q12"></label><input type="text" id="q12" name="q12" style="width: 100px; height: 25px;"></label> for plants in cold conditions.</p><br>
        <p><strong>13</strong> Artificial snow may also be used in carrying out safety checks on <label for="q10"></label><input type="text" id="q13" name="q13" style="width: 100px; height: 25px;"></label></p>
  </div>
  </div>
  </div>
       <!-- Passage 2 -->
       <div id="part-2" class="part">
        <div class="container">
          <div class="left-column">
            <h2>READING PASSAGE 2</h2>
            <p class="center-text"><strong>Why are so Few Tigers Man-eaters</strong></p>
            <p><strong>A</strong> As you leave the Bandhavgarh National Park in central India, there is a notice which shows a huge, placid tiger. The notice says, 'You may not have seen me, but I have seen you'. There are more than a billion people in India and Indian tigers probably see humans every single day of their lives. Tigers can and do kill almost everything they meet in the jungle, they will kill even attack elephants and rhino. Surely, then, it is a little strange that attacks on humans are not more frequent.</p><br>
            <p><strong>B</strong> Some people might argue that these attacks were, in fact, common in the past. British writers of adventure stories, such as Jim Corbett, gave the impression that village life in India in the early years of the twentieth century involved a stage of constant siege by man-eating tigers. But they may have overstated the terror spread by tigers. There were also far more tigers around in those days (probably 60.000 in the subcontinent compared to just 3000 today). So in proportion, attacks appear to have been as rare then as they are today.</p><br>
            <p><strong>C</strong> It is widely assumed that the constraint is fear; but what exactly are tigers afraid of? Can they really know that we may be even better armed than they are? Surely not. Have the species programmed the experiences of all tigers with humans its genes to be inherited as instinct? Perhaps. But I think the explanation may be more simple and, in a way, more intriguing.</p><br>
            <p><strong>D</strong> Since the growth of ethology in the 1950s. we have tried to understand animal behaviour from the animal's point of view. Until the first elegant experiments by pioneers in the field such as Konrad Lorenz, naturalists wrote about animals as if they were slightly less intelligent humans. Jim Corbett's breathless accounts of his duels with man-eaters in truth tell us more about Jim Corbett than they do about the animals. The principle of ethology, on the other hand, requires us to attempt to think in the same way as the animal we are studying thinks, and to observe every tiny detail of its behaviour without imposing our own human significances on its actions.</p><br>
            <p><strong>E</strong> I suspect that a tiger's afraid of humans lies not in some pre-programmed ancestral logic but in the way he actually perceives us visually. If you think like a tiger, a human in a car might appear just to be a part of the car, and because tigers don’t eat cars the human is safe-unless the car is menacing the tiger or its cubs, in which case a brave or enraged tiger may charge. A human on foot is a different sort of puzzle. Imagine a tiger seeing a man who is 1.8m tall. A tiger is less than 1m tall but it may be up to 3m long from head to tail. So when a tiger sees the man face on, it might not be unreasonable for him to assume that the man is 6m long. If he meets a deer of this size, he might attack the animal by leaping on its back, but when he looks behind the mind he can't see a back. From the front, the man is huge, but looked at from the side he all but disappears. This must be very disconcerting. A hunter has to be confident that it can tackle its prey, and no one is confident when they are disconcerted. This is especially true of a solitary hunter such as the tiger and may explain why lions-particularly young lionesses who tend to encourage one another to take risks are more dangerous than tigers.</p><br>
            <p><strong>F</strong> If the theory that a tiger is disconcerted to find that a standing human is both very big and yet somehow invisible is correct, the opposite should be true of a squatting human. A squatting human is half the size and presents twice the spread of back, and more closely resembles a medium-sized deer. If tigers were simply frightened of all humans, then a squatting person would be no more attractive as a target than a standing one. This, however, appears not to be the case. Many incidents of attacks on people involving villagers squatting or bending over to cut grass for fodder or building material.</p><br>
            <p><strong>G</strong> The fact that humans stand upright may therefore not just be something that distinguishes them from nearly all other species, but also a factor that helped them to survive in a dangerous and unpredictable environment.</p><br>
          </div>
          <div class="right-column">
            <h4>Questions 14-16</h4>
            <p>Reading Passage 2 has <strong>SEVEN</strong> paragraphs, <strong>A-G</strong>.</p>
            <p>Which paragraph contains the following information? Tick the correct answer for each question in the table.</p>
            <br>
<table style="width: 98%; border-collapse: collapse; margin-top: 20px; border: 1px solid #ccc; padding: 10px;">
  <thead>
    <tr style="background-color: #f0f0f0;">
      <th style="border: 1px solid #ccc; padding: 10px;">&nbsp;</th>
      <th style="border: 1px solid #ccc; padding: 10px;">A</th>
      <th style="border: 1px solid #ccc; padding: 10px;">B</th>
      <th style="border: 1px solid #ccc; padding: 10px;">C</th>
      <th style="border: 1px solid #ccc; padding: 10px;">D</th>
      <th style="border: 1px solid #ccc; padding: 10px;">E</th>
      <th style="border: 1px solid #ccc; padding: 10px;">F</th>
      <th style="border: 1px solid #ccc; padding: 10px;">G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border: 1px solid #ccc; padding: 10px;"><strong>14</strong> a rejected explanation of why tiger attacks on humans are rare.</td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="a"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="b"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="c"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="d"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="e"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="f"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q14" value="g"></label></td>
    </tr>
    <tr>
      <td style="border: 1px solid #ccc; padding: 10px;"><strong>15</strong> a reason why tiger attacks on humans might be expected to happen more often than they do.</td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="a"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="b"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="c"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="d"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="e"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="f"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q15" value="g"></label></td>
    </tr>
    <tr>
      <td style="border: 1px solid #ccc; padding: 10px;"><strong>16</strong> examples of situations in which humans are more likely to be attacked by tigers.</td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="a"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="b"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="c"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="d"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="e"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="f"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q16" value="g"></label></td>
    </tr>
    <tr>
      <td style="border: 1px solid #ccc; padding: 10px;"><strong>17</strong> a claim about the relative frequency of tiger attacks on humans.</td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="a"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="b"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="c"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="d"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="e"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="f"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q17" value="g"></label></td>
    </tr>
    <tr>
      <td style="border: 1px solid #ccc; padding: 10px;"><strong>18</strong> an explanation of tiger behaviour based on the principles of ethology.</td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="a"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="b"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="c"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="d"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="e"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="f"></label></td>
      <td style="border: 1px solid #ccc; padding: 10px;"><label class="radio-cell"><input type="radio" name="q18" value="g"></label></td>
    </tr>
  </tbody>
</table>
<br>
            <h4>Questions 19-23</h4>
            <p>Do the following statements agree with the information given in Reading Passage 2?</p>
            <div style="display: flex; flex-direction: column; gap: 6px;">
              <div style="display: flex;">
                <strong style="min-width: 100px;">TRUE</strong>
                <span>if the statement agrees with the information</span>
              </div>
              <div style="display: flex;">
                <strong style="min-width: 100px;">FALSE</strong>
                <span>if the statement contradicts the information</span>
              </div>
              <div style="display: flex;">
                <strong style="min-width: 100px;">NOT GIVEN</strong>
                <span>if there is no information on this</span>
              </div>
            </div>
        <br>
    
        <div class="tf-question">
            <p><strong>19</strong> Tigers in the Bandhavgarh National Park are a protected species.</p>
            <label><input type="radio" name="q19" value="true"><span>TRUE</span></label>
            <label><input type="radio" name="q19" value="false"><span>FALSE</span></label>
            <label><input type="radio" name="q19" value="not given"><span>NOT GIVEN</span></label>
        </div>
    
        <div class="tf-question">
            <p><strong>20</strong> Some writers of fiction have exaggerated the danger of tigers to man.</p>
            <label><input type="radio" name="q20" value="true"><span>TRUE</span></label>
            <label><input type="radio" name="q20" value="false"><span>FALSE</span></label>
            <label><input type="radio" name="q20" value="not given"><span>NOT GIVEN</span></label>
        </div>
    
        <div class="tf-question">
            <p><strong>21</strong> The fear of humans may be passed down in a tiger's genes.</p>
            <label><input type="radio" name="q21" value="true"><span>TRUE</span></label>
            <label><input type="radio" name="q21" value="false"><span>FALSE</span></label>
            <label><input type="radio" name="q21" value="not given"><span>NOT GIVEN</span></label>
        </div>
    
        <div class="tf-question">
            <p><strong>22</strong> Konrad Lorenz claimed that some animals are more intelligent than humans.</p>
            <label><input type="radio" name="q22" value="true"><span>TRUE</span></label>
            <label><input type="radio" name="q22" value="false"><span>FALSE</span></label>
            <label><input type="radio" name="q22" value="not given"><span>NOT GIVEN</span></label>
        </div>
    
        <div class="tf-question">
            <p><strong>23</strong> Ethology involves applying principles of human behaviour to animals.</p>
            <label><input type="radio" name="q23" value="true"><span>TRUE</span></label>
            <label><input type="radio" name="q23" value="false"><span>FALSE</span></label>
            <label><input type="radio" name="q23" value="not given"><span>NOT GIVEN</span></label>
        </div>
        
        <h4>Questions 24-26</h4>
        <p>Choose the correct answer, <strong>A. B, C or D</strong>.</p>
        <div class="mpc-question">
          <p><strong>24</strong> Why do tigers rarely attack people in cars?</p>
          <label><input type="radio" name="q24" value="a"><span><strong>A</strong> They have learned that cars are not dangerous.</span></label>
          <label><input type="radio" name="q24" value="b"><span><strong>B</strong> They realise that people in cars cannot be harmed.</span></label>
          <label><input type="radio" name="q24" value="c"><span><strong>C</strong> They do not think people in cars are living creatures.</span></label>
          <label><input type="radio" name="q24" value="d"><span><strong>D</strong> They do not want to put their cubs at risk.</span></label>
        </div>
        <div class="mpc-question">
          <p><strong>25</strong> The writer says that tigers rarely attack a man who is standing up because</p>
          <label><input type="radio" name="q25" value="a"><span><strong>A</strong> they are afraid of the man's height.</span></label>
          <label><input type="radio" name="q25" value="b"><span><strong>B</strong> they are confused by the man's shape.</span></label>
          <label><input type="radio" name="q25" value="c"><span><strong>C</strong> they are puzzled by the man's lack of movement.</span></label>
          <label><input type="radio" name="q25" value="d"><span><strong>D</strong> they are unable to look at the man directly.</span></label>
        </div>
        <div class="mpc-question">
          <p><strong>26</strong> A human is more vulnerable to tiger attack when squatting because</p>
          <label><input type="radio" name="q26" value="a"><span><strong>A</strong> he may be unaware of the tiger's approach.</span></label>
          <label><input type="radio" name="q26" value="b"><span><strong>B</strong> he cannot easily move his head to see behind him.</span></label>
          <label><input type="radio" name="q26" value="c"><span><strong>C</strong> his head becomes a better target for the tiger.</span></label>
          <label><input type="radio" name="q26" value="d"><span><strong>D</strong> his back appears longer in relation to his height.</span></label>
        </div>
        <p></p>
          </div>
        </div>
      </div>

    <!-- Passage 3 -->
    <div id="part-3" class="part">
      <div class="container">
        <div class="left-column">
          <h2>READING PASSAGE 3</h2>
          <p class="center-text"><strong>Keep Taking the Tablets</strong></p>
          <p>In the opening pages of Aspirin: The Remarkable Story of a Wonder Drug, Diarmuid Jeffreys describes this little white pill as 'one of the most amazing creations in medical history, a drug so astonishingly versatile that it can relieve headache, ease your aching limbs, lower your temperature and treat some of the deadliest human diseases'.</p></br>
          <p>Its properties have been known for thousands of years. Ancient Egyptian physicians used extracts from the willow tree as an analgesic, or pain killer. Centuries later the Greek physician Hippocrates recommended the bark of the willow tree as a remedy for the pains of childbirth and as a fever reducer. But it wasn't until the eighteenth and nineteenth centuries that salicylates the chemical found in the willow tree became the subject of serious scientific investigation. The race was on to identify the active ingredient and to replicate it synthetically. At the end of the nineteenth century a German company, Friedrich Bayer & Co. succeeded in creating a relatively safe and very effective chemical compound, acetylsalicylic acid, which was renamed aspirin.</p></br>
          <p>The late nineteenth century was a fertile period for experimentation, partly because of the hunger among scientists to answer some of the great scientific questions, but also because those questions were within their means to answer. One scientist in a laboratory with some chemicals and a test tube could make significant breakthroughs whereas today, in order to map the human genome for instance, one needs 'an army of researchers, a bank of computers and millions and millions of dollars.'</p></br>
          <p>But an understanding of the nature of science and scientific inquiry is not enough on its own to explain how society innovates. In the nineteenth century, scientific advance was closely linked to the industrial revolution. This was a period when people frequently had the means, motive and determination to take an idea and turn it into reality. In the case of aspirin that happened piecemeal - a series of minor, often unrelated advances, fertilised by the century's broader economic, medical and scientific developments, that led to one big final breakthrough.</p></br>
          <p>The link between big money and pharmaceutical innovation is also a significant one. Aspirin's continued shelf life was ensured because, for the first 70 years of its life, huge amounts of money were put into promoting it as an ordinary everyday analgesic. In the 1070s other analgesics, such as ibuprofen and paracetamol, were entering the market, and the pharmaceutical companies then focused on publicising these new drugs. But just at the same time, discoveries were made regarding the beneficial role of aspirin in preventing heart attacks, strokes and other afflictions. Had it not been for these findings, this pharmaceutical marvel may well have disappeared.</p></br>
          <p>So the relationship between big money and drugs is an odd one. Commercial markets are necessary for developing new products and ensuring that they remain around long enough for scientists to carry out research on them. But the commercial markets are just as likely to kill off' certain products when something more attractive comes along. In the case of aspirin, a potential 'wonder drug* was around for over 70 years without anybody investigating the way in which it achieved its effects, because they were making more than enough money out of it as it was. If ibuprofen or paracetamol had entered the market just a decade earlier, aspirin might then not be here today. It would be just another forgotten drug that people hadn't bothered to explore.</p></br>
          <p>None of the recent discoveries of aspirin's benefits was made by the big pharmaceutical companies; they were made by scientists working in the public sector. 'The reason for that is very simple and straightforward,' Jeffreys says in his book. 'Drug companies will only pursue research that is going to deliver financial benefits. There's no profit in aspirin anymore. It is incredibly inexpensive with tiny profit margins and it has no patent anymore, so anyone can produce it.' In fact, there's almost a disincentive for drug companies to further boost the drug, he argues, as it could possibly put them out of business by stopping them from selling their more expensive brands.</p></br>
          <p>So what is the solution to a lack of commercial interest in further exploring the therapeutic benefits of aspirin? More public money going into clinical trials, says Jeffreys. 'If I were the Department of Health. I would say “this is a very inexpensive drug. There may be a lot of other things we could do with it. 'We should put a lot more money into trying to find out.'</p></br>
          <p>Jeffreys' book which not only tells the tale of a 'wonder drug' but also explores the nature of innovation and the role of big business, public money and regulation reminds us why such research is so important.</p>
        </div>
        <div class="right-column">
          <h4>Questions 27-32</h4>
          <p>Complete each sentence with the correct ending, <strong>A-H</strong>.</p>
          <p>Write the correct letter, <strong>A-H</strong>, next to questions 27-32.</p>
          <p></p>
          <p style= font-size:14pt;><strong>List of endings</strong></p>
          <div style="display: flex; flex-direction: column; gap: 6px;">
            <div style="display: flex;">
              <strong style="min-width: 30px;">A</strong>
              <span>the discovery of new medical applications.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">B</strong>
              <span>the negative effects of publicity.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">C</strong>
              <span>the large pharmaceutical companies.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">D</strong>
              <span>the industrial revolution.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">E</strong>
              <span>the medical uses of a particular tree.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">F</strong>
              <span>the limited availability of new drugs.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">G</strong>
              <span>the chemical found in the willow tree.</span>
            </div>
            <div style="display: flex;">
              <strong style="min-width: 30px;">H</strong>
              <span>commercial advertising campaigns.</span>
            </div>
          </div>
          <br>
            <p><strong>27</strong> Ancient Egyptian and Greek doctors were aware of <label for="q27"></label><input type="text" id="q27" name="q27" style="width: 100px; height: 25px;"></label></p><br>

            <p><strong>28</strong> Frederick Bayer & Co were able to reproduce <label for="q28"></label><input type="text" id="q28" name="q28" style="width: 100px; height: 25px;"></label></p><br>

            <p><strong>29</strong> The development of aspirin was partly due to the effects of <label for="q29"></label><input type="text" id="q29" name="q29" style="width: 100px; height: 25px;"></label></p><br>

            <p><strong>30</strong> The creation of a market for aspirin as a painkiller was achieved through <label for="q30"></label><input type="text" id="q30" name="q30" style="width: 100px; height: 25px;"></label></p><br>

            <p><strong>31</strong> Aspirin might have become unavailable without <label for="q31"></label><input type="text" id="q31" name="q31" style="width: 100px; height: 25px;"></label></p><br>

            <p><strong>32</strong> The way in which aspirin actually worked was not investigated by <label for="q32"></label><input type="text" id="q32" name="q32" style="width: 100px; height: 25px;"></label></p><br>
          <h4>Questions 33-37</h4>
        <p>Do the following statements agree with the views of the writer in Reading Passage 3?</p>
        <div style="display: flex; flex-direction: column; gap: 6px;">
          <div style="display: flex;">
            <strong style="min-width: 100px;">YES</strong>
            <span>if the statement agrees with the views of the writer</span>
          </div>
          <div style="display: flex;">
            <strong style="min-width: 100px;">NO</strong>
            <span>if the statement contradicts the views of the writer</span>
          </div>
          <div style="display: flex;">
            <strong style="min-width: 100px;">NOT GIVEN</strong>
            <span>if it is impossible to say what the writer thinks about this</span>
          </div>
        </div>
    <br>

    <div class="tf-question">
        <p><strong>33</strong> For nineteenth-century scientists, small-scale research was enough to make important discoveries.</p>
        <label><input type="radio" name="q33" value="yes"><span>YES</span></label>
        <label><input type="radio" name="q33" value="no"><span>NO</span></label>
        <label><input type="radio" name="q33" value="not given"><span>NOT GIVEN</span></label>

    <div class="tf-question">
        <p><strong>34</strong> The nineteenth-century industrial revolution caused a change in the focus of scientific research.</p>
        <label><input type="radio" name="q34" value="yes"><span>YES</span></label>
        <label><input type="radio" name="q34" value="no"><span>NO</span></label>
        <label><input type="radio" name="q34" value="not given"><span>NOT GIVEN</span></label>
    </div>

    <div class="tf-question">
        <p><strong>35</strong> The development of aspirin in the nineteenth century followed a structured pattern of development.</p>
        <label><input type="radio" name="q35" value="yes"><span>YES</span></label>
        <label><input type="radio" name="q35" value="no"><span>NO</span></label>
        <label><input type="radio" name="q35" value="not given"><span>NOT GIVEN</span></label>
    </div>

    <div class="tf-question">
        <p><strong>36</strong> In the 1970s sales of new analgesic drugs overtook sales of aspirin.</p>
        <label><input type="radio" name="q36" value="yes"><span>YES</span></label>
        <label><input type="radio" name="q36" value="no"><span>NO</span></label>
        <label><input type="radio" name="q36" value="not given"><span>NOT GIVEN</span></label>
    </div>

    <div class="tf-question">
        <p><strong>37</strong> Commercial companies may have both good and bad effects on the availability of pharmaceutical products.</p>
        <label><input type="radio" name="q37" value="yes"><span>YES</span></label>
        <label><input type="radio" name="q37" value="no"><span>NO</span></label>
        <label><input type="radio" name="q37" value="not given"><span>NOT GIVEN</span></label>
    </div>

          <h4>Questions 38-40</h4>
          <p>Complete the summary below. Choose the correct word for each answer and move it into the gap.</p>
          <p></p>
          <p class="center-text" style="margin: 5px; font-size: 14pt;"><strong>Research into aspirin</strong></p>
          <p>
            Jeffreys argues that the reason why <strong>38</strong>&nbsp;<span class="drop-target" id="q38" name="q38" ondragover="allowDrop(event)" ondrop="drop(event)">&nbsp;</span> did not find out about new uses of aspirin is that aspirin is no longer a <strong>39</strong>&nbsp;<span class="drop-target" id="q39" name="q39" ondragover="allowDrop(event)" ondrop="drop(event)">&nbsp;</span>drug. He, therefore, suggests that there should be <strong>40</strong><span class="drop-target" id="q40" name="q40" ondragover="allowDrop(event)" ondrop="drop(event)">&nbsp;</span>support for further research into the possible applications of the drug.  
          </p>
          <div class="word-bank">
            <strong>List of words:</strong>
            <p></p>
            <span class="word" data-text="useful" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">useful</span>
            <span class="word" data-text="cheap" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">cheap</span>
            <span class="word" data-text="state" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">state</span>
            <span class="word" data-text="international" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">international</span>
            <span class="word" data-text="major drug companies" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">major drug companies</span>
            <span class="word" data-text="profitable" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">profitable</span>
            <span class="word" data-text="commercial" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">commercial</span>
            <span class="word" data-text="public sector scientists" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">public sector scientists</span>
            <span class="word" data-text="health officials" style="margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border: 1px solid #ccc;">health officials</span>
          </div>
        </div>
      </div>
    </div>
    </div>
    <!-- Fixed Bottom Nav INSIDE test-container -->
<div style="height: 80px;" id="footer-nav" style="display: none;">
  <div class="nav-left">
  <div class="part-tab" onclick="togglePartNav(1)">Passage 1</div>
  <div class="question-nav hidden" id="part-1-qs">
  <button onclick="scrollToQuestion('q1'); showPart(1)">1</button><button onclick="scrollToQuestion('q2'); showPart(1)">2</button><button onclick="scrollToQuestion('q3'); showPart(1)">3</button><button onclick="scrollToQuestion('q4'); showPart(1)">4</button><button onclick="scrollToQuestion('q5'); showPart(1)">5</button><button onclick="scrollToQuestion('q6'); showPart(1)">6</button><button onclick="scrollToQuestion('q7'); showPart(1)">7</button><button onclick="scrollToQuestion('q8'); showPart(1)">8</button><button onclick="scrollToQuestion('q9'); showPart(1)">9</button><button onclick="scrollToQuestion('q10'); showPart(1)">10</button><button onclick="scrollToQuestion('q11'); showPart(1)">11</button><button onclick="scrollToQuestion('q12'); showPart(1)">12</button><button onclick="scrollToQuestion('q13'); showPart(1)">13</button>
  </div>
  <div class="part-tab" onclick="togglePartNav(2)">Passage 2</div>
  <div class="question-nav hidden" id="part-2-qs">
  <button onclick="scrollToQuestion('q14'); showPart(2)">14</button><button onclick="scrollToQuestion('q15'); showPart(2)">15</button><button onclick="scrollToQuestion('q16'); showPart(2)">16</button><button onclick="scrollToQuestion('q17'); showPart(2)">17</button><button onclick="scrollToQuestion('q18'); showPart(2)">18</button><button onclick="scrollToQuestion('q19'); showPart(2)">19</button><button onclick="scrollToQuestion('q20'); showPart(2)">20</button><button onclick="scrollToQuestion('q21'); showPart(2)">21</button><button onclick="scrollToQuestion('q22'); showPart(2)">22</button><button onclick="scrollToQuestion('q23'); showPart(2)">23</button><button onclick="scrollToQuestion('q24'); showPart(2)">24</button><button onclick="scrollToQuestion('q25'); showPart(2)">25</button><button onclick="scrollToQuestion('q26'); showPart(2)">26</button>
  </div>
  <div class="part-tab" onclick="togglePartNav(3)">Passage 3</div>
  <div class="question-nav hidden" id="part-3-qs">
  <button onclick="scrollToQuestion('q27'); showPart(3)">27</button><button onclick="scrollToQuestion('q28'); showPart(3)">28</button><button onclick="scrollToQuestion('q29'); showPart(3)">29</button><button onclick="scrollToQuestion('q30'); showPart(3)">30</button><button onclick="scrollToQuestion('q31'); showPart(3)">31</button><button onclick="scrollToQuestion('q32'); showPart(3)">32</button><button onclick="scrollToQuestion('q33'); showPart(3)">33</button><button onclick="scrollToQuestion('q34'); showPart(3)">34</button><button onclick="scrollToQuestion('q35'); showPart(3)">35</button><button onclick="scrollToQuestion('q36'); showPart(3)">36</button><button onclick="scrollToQuestion('q37'); showPart(3)">37</button><button onclick="scrollToQuestion('q38'); showPart(3)">38</button><button onclick="scrollToQuestion('q39'); showPart(3)">39</button><button onclick="scrollToQuestion('q40'); showPart(3)">40</button>
  </div>
  </div>
  <div class="timer" id="timer">60:00</div>
  <div class="nav-right">
  <button class="submit-button" onclick="submitQuiz()">Submit</button>
  </div>
  </div>
  </div>

    <p id="testOverMessage" style="display: none; text-align: center;">
      The test is over.
      <a href="#" onclick="window.close()">Click here to see your result</a>
    </p>

    <script>
      function showPassage(n) {
        for (let i = 1; i <= 3; i++) {
          document.getElementById("passage-" + i).classList.remove("active");
        }
        document.getElementById("passage-" + n).classList.add("active");
      }

      let countdown;
let timerDisplay = document.getElementById("timer");

function startTimer() {
  const totalTime = 60 * 60 * 1000; // 60 phút (ms)
  const startTime = Date.now(); // ghi lại thời điểm bắt đầu

  clearInterval(countdown);
  countdown = setInterval(function () {
    const elapsed = Date.now() - startTime;
    const remaining = totalTime - elapsed;

    if (remaining <= 0) {
      timerDisplay.textContent = "0:00";
      clearInterval(countdown);
      submitQuiz();
      return;
    }

    const minutes = Math.floor(remaining / 60000);
    const seconds = Math.floor((remaining % 60000) / 1000);
    timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

    if (remaining <= 600000) { // 10 phút cuối
      timerDisplay.style.color = "#FF0000";
    }
  }, 1000);
}

function startReading() {
  document.getElementById('start-screen').classList.add('hidden');
  document.getElementById("main-content").style.display = "block";
  document.getElementById('footer-nav').classList.remove('hidden');
  startTimer();
}


      function formatAnswer(text) {
        if (text === "-") return "-";
        if (text === "notgiven") return "Not Given";
        if (text === "true") return "True";
        if (text === "false") return "False";
        if (text === "yes") return "Yes";
        if (text === "no") return "No";
        return text;
      }

      function submitQuiz() {
        let correctAnswers = 0;
  let resultsHTML = `
    <div style="max-width: 900px; margin: 20px auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); font-family: 'Segoe UI', sans-serif;">
      <h2 style="text-align: center; margin-bottom: 20px; color: #800000;">Test Results</h2>
  `;

  const correctAnswersMap = {
    q1: ["a problem and a solution"],
    q2: ["snow formation in nature"],
    q3: ["artificial process, natural product"],
    q4: ["the need for different varieties of snow"],
    q5: ["new method for calculating modifications"],
    q6: ["considering ecological costs"],
    q7: ["applications beyond the ski slopes"],
    q8: ["compressed"],
    q9: ["tiny droplets", "droplets"],
    q10:["ice crystals"],
    q11:["energy"],
    q12:["insulation"],
    q13:["aircraft"],
    q14:["c"],
    q15:["a"],
    q16:["f"],
    q17:["b"],
    q18:["e"],
    q19: "not given",
    q20: "true",
    q21: "true",
    q22: "not given",
    q23: "false",
    q24: "c",
    q25: "b",
    q26: "d",
    q27: ["e"],
    q28: ["g"],
    q29: ["d"],
    q30: ["h"],
    q31: ["a"],
    q32: ["c"],
    q33: "yes",
    q34: "not given",
    q35: "no",
    q36: "not given",
    q37: "yes",
    q38: ["major drug companies"],
    q39: ["profitable"],
    q40: ["state"]
  };

  function renderPassage(title, from, to) {
  const totalQuestions = to - from + 1;
  const half = Math.ceil(totalQuestions / 2);

  let html = `
    <h3 style="margin-top: 30px; color: #333;">${title}</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
      <div style="flex: 1; min-width: 300px;">
  `;

  for (let i = from; i < from + half; i++) {
    if (i > to) break;

    const qid = "q" + i;
    let userAnswer = "-";

    if (i <= 7 || (i >= 38 && i <= 40)) {
      const dropEl = document.getElementById(qid);
      userAnswer = dropEl ? dropEl.textContent.trim().toLowerCase() : "-";
    } else if (i >= 8 && i <= 13 || (i >= 27 && i <= 32)) {
      const input = document.getElementById(qid);
      userAnswer = input ? input.value.trim().toLowerCase() : "-";
    } else if ((i >= 14 && i <= 18) || (i >= 24 && i <= 26) || (i >= 33 && i <= 37)) {
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      userAnswer = selected ? selected.value.toLowerCase() : "-";
    } else if (i >= 19 && i <= 23) {
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      userAnswer = selected ? selected.value.toLowerCase() : "-";
    }

    const correct = correctAnswersMap[qid];
    const correctList = Array.isArray(correct) ? correct : [correct];
    const isCorrect = correctList.includes(userAnswer);

    if (isCorrect) correctAnswers++;

    const shouldUppercase = (i >= 14 && i <= 26) || (i >= 27 && i <= 37);
    const displayUserAnswer = shouldUppercase && userAnswer !== "-" ? userAnswer.toUpperCase() : userAnswer;
    const displayCorrectAnswer = shouldUppercase ? correctList[0].toUpperCase() : correctList[0];

    html += `
      <div style="display: flex; align-items: center; margin: 8px 0;">
        <div style="width: 32px; height: 32px; background: #000066; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">${i}</div>
        <div style="flex: 1;">
          ${displayUserAnswer !== "-" ? displayUserAnswer : "-"} : ${isCorrect ? "✔️" : "❌"}
          ${!isCorrect ? `<span style="color: #800000;"> → ${displayCorrectAnswer}</span>` : ""}
        </div>
      </div>
    `;
  }

  html += `
      </div> <!-- end left column -->
      <div style="flex: 1; min-width: 300px;">
  `;

  for (let i = from + half; i <= to; i++) {
    const qid = "q" + i;
    let userAnswer = "-";

    if (i <= 7 || (i >= 38 && i <= 40)) {
      const dropEl = document.getElementById(qid);
      userAnswer = dropEl ? dropEl.textContent.trim().toLowerCase() : "-";
    } else if (i >= 8 && i <= 13 || (i >= 27 && i <= 32)) {
      const input = document.getElementById(qid);
      userAnswer = input ? input.value.trim().toLowerCase() : "-";
    } else if ((i >= 14 && i <= 18) || (i >= 24 && i <= 26) || (i >= 33 && i <= 37)) {
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      userAnswer = selected ? selected.value.toLowerCase() : "-";
    } else if (i >= 19 && i <= 23) {
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      userAnswer = selected ? selected.value.toLowerCase() : "-";
    }

    const correct = correctAnswersMap[qid];
    const correctList = Array.isArray(correct) ? correct : [correct];
    const isCorrect = correctList.includes(userAnswer);

    if (isCorrect) correctAnswers++;

    const shouldUppercase = (i >= 14 && i <= 26) || (i >= 27 && i <= 37);
    const displayUserAnswer = shouldUppercase && userAnswer !== "-" ? userAnswer.toUpperCase() : userAnswer;
    const displayCorrectAnswer = shouldUppercase ? correctList[0].toUpperCase() : correctList[0];

    html += `
      <div style="display: flex; align-items: center; margin: 8px 0;">
        <div style="width: 32px; height: 32px; background: #000066; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">${i}</div>
        <div style="flex: 1;">
          ${displayUserAnswer !== "-" ? displayUserAnswer : "-"} : ${isCorrect ? "✔️" : "❌"}
          ${!isCorrect ? `<span style="color: #800000;"> → ${displayCorrectAnswer}</span>` : ""}
        </div>
      </div>
    `;
  }

  html += `
      </div> <!-- end right column -->
    </div> <!-- end flex container -->
  `;
  return html;
}
// Hàm tính Band Score dựa theo số câu đúng
function calculateBandScore(score) {
  if (score <= 1) return 1.0;
  if (score>=2 && score <= 3) return 2.0;
  if (score>=4 && score <= 5) return 2.5;
  if (score>=6 && score <= 7) return 3.0;
  if (score>=8 && score <= 9) return 3.5;
  if (score>=10 && score <= 12) return 4.0;
  if (score>=13 && score <= 14) return 4.5;
  if (score>=15 && score <= 19) return 5.0;
  if (score>=20 && score <= 23) return 5.5;
  if (score>=24 && score <= 26) return 6.0;
  if (score>=27 && score <= 29) return 6.5;
  if (score>=30 && score <= 32) return 7.0;
  if (score>=33 && score <= 34) return 7.5;
  if (score>=35 && score <= 36) return 8.0;
  if (score>=37 && score <= 38) return 8.5;
  return 9.0;
}

// Render bảng kết quả chia theo Passage
resultsHTML += renderPassage("Passage 1: Question 1-13", 1, 13);
resultsHTML += renderPassage("Passage 2: Question 14-26", 14, 26);
resultsHTML += renderPassage("Passage 3: Question 27-40", 27, 40);

// Tính Band Score
const bandScore = calculateBandScore(correctAnswers);

// Hiển thị tổng điểm và Band Score
resultsHTML += `
  <div style="display: flex; justify-content: center; gap: 50px; margin-top: 30px; flex-wrap: wrap;">
    <div style="display: flex; flex-direction: column; align-items: center;">
      <div style="width: 120px; height: 120px; border-radius: 50%; border: 8px solid #ccc; display: flex; align-items: center; justify-content: center; background: #e6f2ff;">
        <span id="band-score" style="font-size: 32px; color: #800000; font-weight: bold;">${bandScore.toFixed(1)}</span>
      </div>
      <div style="margin-top: 10px; font-size: 18px;">Band Score</div>
    </div>
    <div style="display: flex; flex-direction: column; align-items: center;">
      <div style="width: 120px; height: 120px; border-radius: 50%; border: 8px solid #ccc; display: flex; align-items: center; justify-content: center; background: #e6ffe6;">
        <span style="font-size: 32px; color: #008000; font-weight: bold;">${correctAnswers}/40</span>
      </div>
      <div style="margin-top: 10px; font-size: 18px;">Correct Answers</div>
    </div>
  </div>
`;

// Ẩn toàn bộ passages khi nộp bài
for (let i = 1; i <= 3; i++) {
  const el = document.getElementById("part-" + i);
  if (el) el.style.display = "none";
}

// Ẩn phần footer (timer và submit) và passage navigation
const footerEl = document.getElementById("footer-nav");
if (footerEl) footerEl.classList.add("hidden");

const navEl = document.getElementById("part-nav");
if (navEl) navEl.classList.add("hidden");

// Hiển thị kết quả
const resultDiv = document.createElement("div");
resultDiv.innerHTML = resultsHTML;
document.body.appendChild(resultDiv);

// Gửi kết quả về trang cha (kèm answers)
const currentUserId = sessionStorage.getItem("currentUserId");
if (window.opener && currentUserId) {
  // Thu thập tất cả đáp án người dùng
  let userAnswers = {};
  for (let i = 1; i <= 40; i++) {
    const qid = "q" + i;
    let answer = "-";

    if (i <= 7 || (i >= 38 && i <= 40)) {
      const dropEl = document.getElementById(qid);
      answer = dropEl ? dropEl.textContent.trim() : "-";
    } else if ((i >= 8 && i <= 13) || (i >= 27 && i <= 32)) {
      const input = document.getElementById(qid);
      answer = input ? input.value.trim() : "-";
    } else {
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      answer = selected ? selected.value : "-";
    }

    userAnswers[qid] = answer;
  }

  window.opener.postMessage({
    id: currentUserId,
    type: "reading",
    level: "Placement",
    score: correctAnswers,
    band: bandScore,
    answers: userAnswers,
    resultHTML: resultsHTML // ✅ Thêm dòng này
  }, "*");
  document.body.innerHTML = `
  <div style="
    display: flex;
    justify-content: center;
    align-items: center;
    height: 50vh;
    font-family: Arial;
  ">
    <div style="max-width: 600px; text-align: center;">
      <h2 style="color: #800000; margin-bottom: 20px;">
        Your reading has been submitted successfully!
      </h2>
      <p style="font-size: 16px;">
        You may now close this tab.
      </p>
    </div>
  </div>
`;
}
}

function allowDrop(event) {
  event.preventDefault();
}

window.addEventListener("DOMContentLoaded", () => {
  let draggedItem = null;
  let draggedFromDropTarget = null;

  // Thiết lập kéo cho tất cả từ
  document.querySelectorAll('.word').forEach(word => {
    word.setAttribute('draggable', true);

    word.addEventListener('dragstart', function () {
      draggedItem = this;
      draggedFromDropTarget = null;
      this.classList.remove("hidden");
    });

    word.addEventListener('dragend', () => {
      draggedItem = null;
    });
  });

  // Drop vào vùng drop-target
  document.querySelectorAll('.drop-target').forEach(target => {
    target.addEventListener('dragover', allowDrop);
      // ✅ Thêm hiệu ứng khi kéo vào
  target.addEventListener('dragenter', () => {
    target.classList.add('drop-hover');
  });

  // ✅ Bỏ hiệu ứng khi kéo ra
  target.addEventListener('dragleave', () => {
    target.classList.remove('drop-hover');
  });

    target.addEventListener('drop', function (event) {
      event.preventDefault();
      target.classList.remove('drop-hover'); // ✅ Bỏ hiệu ứng khi drop xong
      if (!draggedItem) return;

      const draggedText = draggedItem.getAttribute("data-text");

      // Trả từ cũ về word bank (nếu có)
      const existing = this.querySelector("span");
      if (existing) {
        const existingText = existing.getAttribute("data-text");
        const wordBank = this.closest("body").querySelectorAll('.word');
        const match = [...wordBank].find(el => el.getAttribute("data-text") === existingText);
        if (match) match.classList.remove("hidden");
      }

      // Đặt từ mới
      this.innerHTML = "";
      const span = document.createElement("span");
      span.textContent = draggedText;
      span.setAttribute("data-text", draggedText);
      span.setAttribute("draggable", true);

      span.addEventListener('dragstart', function () {
        draggedItem = span;
        draggedFromDropTarget = this.parentElement;
      });

      span.addEventListener('dragend', () => {
        draggedItem = null;
        draggedFromDropTarget = null;
      });

      this.appendChild(span);

      // Ẩn từ gốc trong word bank
      draggedItem.classList.add("hidden");
      updateAnsweredStatus();  // Gọi lại để đánh dấu đã làm
    });
  });

  // Drop lại vào word bank (nơi từ gốc)
  document.querySelectorAll('.word-bank').forEach(wordBank => {
    wordBank.addEventListener('dragover', allowDrop);

    wordBank.addEventListener('drop', function (event) {
      event.preventDefault();
      if (!draggedItem) return;

      const draggedText = draggedItem.getAttribute("data-text");

      // Xóa từ khỏi drop-target
      if (draggedFromDropTarget) {
        draggedFromDropTarget.innerHTML = '&nbsp;';
        updateAnsweredStatus();
      }

      // Hiện lại từ gốc trong đúng word bank
      const original = [...this.querySelectorAll('.word')].find(
        el => el.getAttribute("data-text") === draggedText
      );
      if (original) original.classList.remove("hidden");
    });
  });
});
window.addEventListener("message", function(event) {
  if (event.data && event.data.type === "logout") {
    window.close();
  }
});
function togglePartNav(partNum) {
  showPart(partNum);
  for (let i = 1; i <= 3; i++) {
    const el = document.getElementById(`part-${i}-qs`);
    if (i === partNum) {
      el.classList.toggle('hidden');
    } else {
      el.classList.add('hidden');
    }
  }
}

function scrollToQuestion(qid) {
  // Tìm input hoặc drop-target theo ID hoặc name
  let target = document.getElementById(qid);

  // Nếu không có ID, thử tìm input radio theo name
  if (!target) {
    target = document.querySelector(`input[name="${qid}"]`);
  }

  // Nếu vẫn không có, thử tìm drop-target
  if (!target) {
    target = document.querySelector(`.drop-target[id="${qid}"]`);
  }

  // Nếu tìm thấy phần tử hợp lệ, scroll tới
  if (target) {
    target.scrollIntoView({ behavior: 'smooth', block: 'center' });
    target.focus?.();
  }
}

function showPart(n) {
  for (let i = 1; i <= 3; i++) {
    const el = document.getElementById("part-" + i);
    if (el) {
      el.classList.remove("active");
    }
  }
  const activeEl = document.getElementById("part-" + n);
  if (activeEl) {
    activeEl.classList.add("active");
  }
}
function updateAnsweredStatus() {
  for (let i = 1; i <= 40; i++) {
    let isAnswered = false;

    const input = document.getElementById("q" + i);
    const btns = document.querySelectorAll(`.question-nav button[onclick*="q${i}"]`);

    if (input) {
      if (input.tagName === "INPUT" && input.value.trim() !== "") {
        isAnswered = true;
      }
      // ✅ Nếu là drop-target (dạng kéo thả)
      if (input.classList.contains("drop-target")) {
        if (input.textContent.trim() !== "" && input.textContent.trim() !== " " && input.textContent.trim() !== "-") {
          isAnswered = true;
        }
      }
    }

    // ✅ Check radio group (MPC)
    if (!isAnswered) {
      const radios = document.querySelectorAll(`input[name="q${i}"]`);
      for (let r of radios) {
        if (r.checked) {
          isAnswered = true;
          break;
        }
      }
    }

    // ✅ Cập nhật viền xanh ở footer
    btns.forEach(btn => {
      btn.classList.toggle("answered", isAnswered);
    });
  }
}
   document.querySelectorAll('input').forEach(el => {
    el.addEventListener('input', updateAnsweredStatus);
  });
  document.querySelectorAll('input[type="radio"]').forEach(el => {
    el.addEventListener('change', updateAnsweredStatus);
  });

  // ✅ Gọi 1 lần đầu tiên sau khi load form
  updateAnsweredStatus();
// ✅ Theo dõi sự kiện drop vào drop-target
document.querySelectorAll('.drop-target').forEach(target => {
    target.addEventListener('drop', () => {
      updateAnsweredStatus();  // Gọi lại để đánh dấu đã làm
    });
  });
  
  // ✅ Đảm bảo DOM đã sẵn sàng trước khi truy cập popup
document.addEventListener("DOMContentLoaded", function () {
  const popup = document.getElementById("highlight-popup");
  const highlightBtn = document.getElementById("highlight-btn");
  const removeBtn = document.getElementById("remove-highlight-btn");

  document.addEventListener("mouseup", function (e) {
  const selection = window.getSelection();
  const selectedText = selection.toString().trim();

  if (!selection.rangeCount || !selectedText.length) {
    popup.style.display = "none";
    return;
  }

  const range = selection.getRangeAt(0);
  const container = range.commonAncestorContainer;
  const mainContent = document.getElementById("main-content");

  // Kiểm tra: nếu không nằm trong #main-content thì không cho popup hiện
  if (!mainContent.contains(container)) {
    popup.style.display = "none";
    return;
  }

  // Nếu nằm trong vùng hợp lệ
  const parent = selection.anchorNode?.parentElement;

  if (parent && parent.classList.contains("highlight-yellow")) {
    highlightBtn.style.display = "none";
    removeBtn.style.display = "inline";
  } else {
    highlightBtn.style.display = "inline";
    removeBtn.style.display = "none";
  }

  popup.style.top = `${e.clientY + window.scrollY - 50}px`;
  popup.style.left = `${e.clientX + window.scrollX}px`;
  popup.style.display = "flex";
});

  highlightBtn.addEventListener("click", function () {
  const selection = window.getSelection();
  if (!selection.rangeCount || selection.isCollapsed) return;

  const range = selection.getRangeAt(0).cloneRange();
  wrapTextNodes(range);

  selection.removeAllRanges();
  popup.style.display = "none";
});

function wrapTextNodes(range) {
  const span = document.createElement("span");
  span.className = "highlight-yellow";

  try {
    // Nếu vùng chọn nằm gọn trong 1 node → dùng surroundContents mượt
    range.surroundContents(span);
  } catch (e) {
    // Nếu lỗi → dùng TreeWalker để xử lý kỹ lưỡng từng phần tử
    fallbackWrap(range);
  }
}
function fallbackWrap(range) {
  const walker = document.createTreeWalker(
    range.commonAncestorContainer,
    NodeFilter.SHOW_TEXT,
    {
      acceptNode: (node) =>
        range.intersectsNode(node) && node.nodeValue.trim().length
          ? NodeFilter.FILTER_ACCEPT
          : NodeFilter.FILTER_REJECT,
    }
  );

  const nodes = [];
  while (walker.nextNode()) nodes.push(walker.currentNode);

  for (let i = nodes.length - 1; i >= 0; i--) {
    const node = nodes[i];
    const highlightSpan = document.createElement("span");
    highlightSpan.className = "highlight-yellow";

    const nodeRange = document.createRange();
    nodeRange.selectNodeContents(node);

    if (node === range.startContainer)
      nodeRange.setStart(node, range.startOffset);
    if (node === range.endContainer)
      nodeRange.setEnd(node, range.endOffset);

    const extracted = nodeRange.extractContents();
    highlightSpan.appendChild(extracted);
    nodeRange.insertNode(highlightSpan);
  }
}
removeBtn.addEventListener("click", function () {
  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0).cloneRange();

  const spans = document.querySelectorAll("span.highlight-yellow");
  let removedAny = false;

  spans.forEach(span => {
    if (range.intersectsNode(span)) {
      const parent = span.parentNode;

      // ✅ Gỡ span nhưng giữ nguyên tất cả node con (kể cả input, drop-target...)
      while (span.firstChild) {
        parent.insertBefore(span.firstChild, span);
      }
      parent.removeChild(span);
      removedAny = true;
    }
  });

  // Nếu chỉ click chứ không bôi, gỡ phần gần nhất
  if (!removedAny && selection.anchorNode) {
    const node = selection.anchorNode.nodeType === Node.TEXT_NODE
      ? selection.anchorNode.parentNode
      : selection.anchorNode;

    const closestSpan = node.closest("span.highlight-yellow");
    if (closestSpan) {
      const parent = closestSpan.parentNode;
      while (closestSpan.firstChild) {
        parent.insertBefore(closestSpan.firstChild, closestSpan);
      }
      parent.removeChild(closestSpan);
    }
  }

  selection.removeAllRanges();
  popup.style.display = "none";
});

  // Nếu user chỉ click (không bôi gì), vẫn thử gỡ phần tử gần nhất
  if (!removedAny && selection.anchorNode) {
    const node = selection.anchorNode.nodeType === Node.TEXT_NODE
      ? selection.anchorNode.parentNode
      : selection.anchorNode;

    const closestSpan = node.closest("span.highlight-yellow");
    if (closestSpan) {
      const parent = closestSpan.parentNode;
      while (closestSpan.firstChild) {
        parent.insertBefore(closestSpan.firstChild, closestSpan);
      }
      parent.removeChild(closestSpan);
    }
  }

  selection.removeAllRanges();
  popup.style.display = "none";
});
    </script>
    <!-- Khoảng đệm tránh bị footer che -->
<div style="height: 100px;"></div>
<div id="highlight-popup">
  <button id="highlight-btn">Highlight</button>
  <button id="remove-highlight-btn" style="display:none;">Remove Highlight</button>
</div>
<script src="../../script.js"></script>
  </body>
</html>
